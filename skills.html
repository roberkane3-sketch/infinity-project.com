
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Show Us Your Info</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <h1>Submit Your Info</h1>
    <p>Please fill your information below.</p>

    <form id="infoForm">
        <input type="text" id="nameInput" placeholder="Your Full Name" required>
        <input type="email" id="emailInput" placeholder="Your Email" required>
        <button type="submit">Submit</button>
    </form>
</div>

<!-- Firebase V8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// ================== Firebase Config ==================
const firebaseConfig = {
  apiKey: "AIzaSyAFKutntyzrXy6GrmVdi0XRl-I-CM7fdpI",
  authDomain: "infinity-project-f9c1b.firebaseapp.com",
  projectId: "infinity-project-f9c1b",
  storageBucket: "infinity-project-f9c1b.appspot.com",
  messagingSenderId: "905786527606",
  appId: "1:905786527606:web:e99b9090b9341c6de77457",
  measurementId: "G-H2950PPK9B",
  databaseURL: "https://infinity-project-f9c1b-default-rtdb.firebaseio.com/"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// ================== Form Submission ==================
document.getElementById("infoForm").addEventListener("submit", function (e) {
    e.preventDefault();

    const name = document.getElementById("nameInput").value.trim();
    const email = document.getElementById("emailInput").value.trim();

    if (!name || !email) {
        alert("يرجى ملء جميع الحقول");
        return;
    }

    // جعل البريد مفتاحًا فريدًا
    const safeEmail = email.replace(/\./g, "_");
    const userRef = database.ref("submissions/" + safeEmail);

    // التحقق هل مسجل مسبقًا
    userRef.once("value")
    .then(snapshot => {
        if (snapshot.exists()) {
            alert("هذا البريد الإلكتروني مسجل مسبقًا ❌");
            return;
        }

        const submission = {
            name: name,
            email: email,
            timestamp: Date.now()
        };

        return userRef.set(submission);
    })
    .then(() => {
        localStorage.setItem("name", name);
        localStorage.setItem("email", email);
        window.location.href = "submit.html";
    })
    .catch(error => {
        console.error(error);
        alert("حدث خطأ أثناء التسجيل ❌");
    });
});
</script>

<div class="shape"></div>
<div class="shape square"></div>
<div class="shape"></div>
<div class="shape square"></div>

</body>
</html>